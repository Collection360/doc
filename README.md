# Collection360 催收系统接入文档

在正式接入之前，请联系我们公司的商务同事，提交必要的贵公司信息。之后，我们将会提供给你公司名称（Company Name）、访问秘钥（Company Secret）、测试和生产环境地址等其它信息。



## 接口列表

### 全局规范

#### 请求

我们的接口均以 HTTP 协议的方式对外提供，并且要求所有请求都必须加上以下两个自定义 Header 以完成对商户身份及请求合法性的校验。

1. X-Company-Name，值是我们提供给你的公司名称（Company Name）
2. X-Company-Secret，值是我们提供给你的访问秘钥（Company Secret）



#### 响应

响应体示例

```json
{
    "code": 200000,
    "message": "Success"
}
```

字段释义

| 名称    | 类型                     | 释义                              |
| ------- | ------------------------ | --------------------------------- |
| code    | 整型                     | 业务处理结果码。参考 **响应码表** |
| message | 字符串                   | 业务处理结果说明信息              |
| data    | JSON Object / JSON Array | 业务处理结果数据                  |



### 创建订单

#### 协议及路径
` POST /order `

#### 请求体示例
```json
{
    "dataList": [
        {
            "order": {
                "id": "orderId",
                "appName": "appName",
                "loanTime": "2021-07-13 12:34",
                "loanAmount": 1234.56,
                "dueAmount": 1500.12,
                "dueDate": "2021-07-19",
                "closeOverdueDay": 15
            },
            "customer": {
                "id": "customerId",
                "idCard": "idCard",
                "name": "customerName",
                "birthday": "2000-01-01",
                "age": 22,
                "phone": 1234567890
            },
            "contactList": [
                {
                    "name": "contactName1",
                    "phone": 9876543211,
                    "type": 10
                }, {
                    "name": "contactName2",
                    "phone": 9876543212,
                    "type": 20
                }
            ]
        }
    ]
}
```
#### 字段释义

| 名称     | 类型                      | 释义         | 是否必填 |
| -------- | ------------------------- | ------------ | -------- |
| dataList | JSON Array，元素类型 Data | 订单数据列表 | 是       |

Data

| 名称        | 类型                         | 释义           | 是否必填 |
| ----------- | ---------------------------- | -------------- | -------- |
| order       | Order                        | 订单信息       | 是       |
| customer    | Customer                     | 客户信息       | 是       |
| contactList | JSON Array，元素类型 Contact | 客户通讯录信息 | 是       |

Order

| 名称            | 类型                                                         | 释义                                                         | 是否必填 |
| --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| id              | 字符串                                                       | 订单标识                                                     | 是       |
| appName         | 字符串                                                       | 应用名称                                                     | 是       |
| loanTime        | 时间字符串，要求格式 yyyy-MM-dd HH:mm，默认时区是北美墨西哥城时区 | 借款时间                                                     | 是       |
| loanAmount      | 小数，单位比索，精度支持小数点后两位                         | 借款金额                                                     | 是       |
| dueDate         | 日期字符串，要求格式 yyyy-MM-dd                              | 应还日期                                                     | 是       |
| dueAmount       | 小数，单位比索，精度支持小数点后两位                         | 应还金额                                                     | 是       |
| closeOverdueDay | 整数                                                         | 停止催收的逾期天数。即当逾期这么多天并且用户未还完款，那么就停止催收 | 是       |

Customer 客户

| 名称           | 类型                             | 释义                 | 是否必填 |
| -------------- | -------------------------------- | -------------------- | -------- |
| id             | 字符串                           | 客户标识             | 是       |
| idCard         | 字符串                           | 客户身份标识         |          |
| name           | 字符串                           | 客户姓名             | 是       |
| fatherLastName | 字符串                           | 父亲姓氏             |          |
| motherLastName | 字符串                           | 母亲姓氏             |          |
| sex            | 整数                             | 性别。1-男性，2-女性 |          |
| birthday       | 日期字符串，要求格式 yyyy-MM-dd  | 生日                 |          |
| age            | 整数                             | 年龄                 |          |
| phone          | 手机号字符串，要求格式是10位数字 | 手机号               | 是       |
| email          | 邮箱字符串                       | 邮箱                 |          |
| bankAccount    | 字符串                           | 银行卡号             |          |
| bankName       | 字符串                           | 银行名称             |          |

Contact 客户通讯录

| 名称  | 类型                             | 释义                                                         | 是否必填 |
| ----- | -------------------------------- | ------------------------------------------------------------ | -------- |
| type  | 整数                             | 联系人类型。10 - 客户本人，20 - 父亲，30 - 母亲，40 - 兄妹，50 - 亲戚，60 - 朋友，70 - 同事，80 - 其它 | 是       |
| name  | 字符串                           | 联系人名称                                                   | 是       |
| phone | 手机号字符串，要求格式是10位数字 | 联系人手机号                                                 | 是       |



#### 响应

##### 响应示例

```json
{
    "code": 200000,
    "message": "Success",
    "data": {
        "received": 2,
        "successList": [
          0
        ],
        "failedList": [
            {
                "index": 1,
                "reason": "order already exists"
            }
        ]
    }
}
```

##### 字段释义

| 名称        | 类型                         | 释义                                                         |
| ----------- | ---------------------------- | ------------------------------------------------------------ |
| recevied    | 整数                         | 接收到的订单个数                                             |
| successList | JSON Array                   | 成功处理的订单列表，值是订单在列表中的索引。例如，0 表示请求订单列表中的第一个订单 |
| failedList  | JSON Array，参考 FailedOrder | 处理失败的订单列表                                           |

FailedOrder

| 名称   | 类型   | 释义                                                         |
| ------ | ------ | ------------------------------------------------------------ |
| index  | 整数   | 订单在列表中的索引。例如，1 表示请求订单列表中的第二个订单   |
| reason | 字符串 | 失败原因。例如，同一个订单不可以创建两次，则返回 order already exists |




### 更新订单
#### 协议及路径

` PUT /order `

#### 请求体示例

```json
{
  "dataList": [
    {
      "orderId": "orderId",
      "dueAmount": 1234.56,
      "closeOverdueDay": 15
    }, {
      "orderId": "orderId2",
      "dueAmount": 9876.54,
      "closeOverdueDay": 20
    },
  ]
}
```

#### 字段释义

| 名称     | 类型                      | 释义         | 是否必填 |
| -------- | ------------------------- | ------------ | -------- |
| dataList | JSON Array，元素类型 Data | 订单数据列表 | 是       |

Data

| 名称            | 类型                                 | 释义                                                         | 是否必填 |
| --------------- | ------------------------------------ | ------------------------------------------------------------ | -------- |
| orderId         | 字符串                               | 订单标识                                                     | 是       |
| dueAmount       | 小数，单位比索，精度支持小数点后两位 | 应还金额                                                     | 是       |
| closeOverdueDay | 整数                                 | 停止催收的逾期天数。即当逾期这么多天并且用户未还完款，那么就停止催收 | 是       |



#### 响应

##### 响应示例

```json
{
    "code": 200000,
    "message": "Success",
    "data": {
        "received": 2,
        "successList": [
          0
        ],
        "failedList": [
            {
                "index": 1,
                "reason": "Order does not exists"
            }
        ]
    }
}
```

##### 字段释义

同创建订单的响应字段释义



### 创建订单还款记录

#### 协议及路径

` POST /order/repayment `

#### 请求体示例

```json
{
  "orderId": "orderId",
  "isSettled": false,
  "amount": 300.12,
  "totalAmount": "1023.45",
  "time": "2021-07-20 12:34"
}
```

#### 字段释义

| 名称        | 类型                                                         | 释义                                                         | 是否必填 |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| orderId     | 字符串                                                       | 订单标识                                                     | 是       |
| isSettled   | 布尔                                                         | 是否结清。如果本次还款后用户已还清所有应还金额，那么这就是一次结清还款。 | 是       |
| amount      | 小数                                                         | 本次还款金额                                                 | 是       |
| totalAmount | 小数                                                         | 总共还款金额                                                 | 是       |
| time        | 时间字符串，要求格式 yyyy-MM-dd HH:mm，默认时区是北美墨西哥城时区 | 还款时间                                                     | 是       |

#### 响应

##### 响应示例

成功的响应示例

```json
{
    "code": 200000,
    "message": "Success"
}
```

失败的响应示例

```json
{
    "code": 403001,
    "message": "Order does not exists"
}
```



## 响应码

| 响应码 | 原因                                                         |
| ------ | ------------------------------------------------------------ |
| 200000 | 处理成功                                                     |
| 400001 | 请求参数校验失败                                             |
| 400002 | 请求体不可以为空，通常是指 POST 请求体为空                   |
| 400014 | 商户不存在，指 X-Company-Name 对应的商户不存在               |
| 400015 | 商户被禁用，指 X-Company-Name 对应的商户虽然存在，但是被禁用 |
| 400016 | 商户与秘钥不一致，指 X-Company-Name 对应商户的秘钥与 X-Company-Secret 不一致 |
| 403001 | 订单不存在                                                   |
| 403002 | 订单已存在                                                   |
| 403003 | 订单状态不能改变。例如，当前订单已还款出催，那么不能再次更新它的还款记录。 |
| 500000 | 服务器异常                                                   |

